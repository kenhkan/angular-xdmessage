<!DOCTYPE html>
<html>
<head>
  <title>index.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../", thisFile = "app/xdmessage/index.coffee", defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>
  <script src="../../fileSearch.js"></script>
  <script src="../../goToLine.js"></script>
  <link rel="stylesheet" href="../../fileSearch.css" />
  <link rel="stylesheet" href="../../goToLine.css" />
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>index.coffee</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nv">module = </span><span class="nx">angular</span><span class="p">.</span><span class="nx">module</span> <span class="s">&#39;xdmessage&#39;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>This must happen outside of Angular because Angular could erase the URL
before any code in Angular runs</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nv">opener = </span><span class="kc">null</span>
<span class="nv">token = </span><span class="kc">null</span>
<span class="nv">search = </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">[</span><span class="mi">1</span><span class="p">...]</span>
<span class="nv">terms = </span><span class="nx">search</span><span class="p">.</span><span class="nx">split</span> <span class="s">&#39;&amp;&#39;</span>

<span class="k">for</span> <span class="nx">term</span> <span class="k">in</span> <span class="nx">terms</span>
  <span class="p">[</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">term</span><span class="p">.</span><span class="nx">split</span> <span class="s">&#39;=&#39;</span>
  <span class="k">switch</span> <span class="nx">key</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<p>The window host URL</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">when</span> <span class="s">&#39;opener&#39;</span>
      <span class="nv">opener = </span><span class="nb">decodeURIComponent</span> <span class="nx">value</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>The session token</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">when</span> <span class="s">&#39;XDMessage_token&#39;</span>
      <span class="nv">token = </span><span class="nx">value</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">factory</span> <span class="s">&#39;xdmessage&#39;</span><span class="p">,</span> <span class="nf">($window) -&gt;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Get the XDMessage object by providing a URL to load as iframe in the
specified container. If no URL or container is provided, this is treated
as the iframe itself. It would also assume that this is the iframe when
<code>window.self != window.top</code> or container has not been set.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">url</span>
      <span class="dox_type">String=</span>
      <span>The URL to load as iframe</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">params.container</span>
      <span class="dox_type">DOMElement</span>
      <span>The DOM containing the iframe</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">done</span>
      <span class="dox_type">function</span>
      <span>Called with the XDMessage object</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">create: </span><span class="nf">(url, params, done) -&gt;</span>
    <span class="p">{</span> <span class="nx">container</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">params</span>

    <span class="nv">create = </span><span class="nf">(XDMessage) -&gt;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<p>Initiate as iframe</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="k">if</span> <span class="nx">$window</span><span class="p">.</span><span class="nx">self</span> <span class="o">is</span> <span class="nx">$window</span><span class="p">.</span><span class="nx">top</span> <span class="o">and</span> <span class="nx">container</span><span class="o">?</span> <span class="o">and</span> <span class="nx">url</span><span class="o">?</span>
        <span class="nx">done</span> <span class="k">new</span> <span class="nx">XDMessage</span> <span class="nx">url</span><span class="p">,</span>
          <span class="nv">container: </span><span class="nx">container</span>
          <span class="nv">target: </span><span class="nx">container</span>
          <span class="nv">style:</span>
            <span class="nv">position: </span><span class="s">&#39;absolute&#39;</span>
            <span class="nv">left: </span><span class="s">&#39;0px&#39;</span>
            <span class="nv">top: </span><span class="s">&#39;0px&#39;</span>
            <span class="nv">width: </span><span class="s">&#39;100%&#39;</span>
            <span class="nv">height: </span><span class="s">&#39;100%&#39;</span>
      <span class="k">else</span>
        <span class="nx">done</span> <span class="k">new</span> <span class="nx">XDMessage</span>
          <span class="nv">windowHostURL: </span><span class="nx">opener</span>
          <span class="nv">token: </span><span class="nx">token</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<p>AMD</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">define</span> <span class="o">is</span> <span class="s">&quot;function&quot;</span> <span class="o">and</span> <span class="nx">define</span><span class="p">.</span><span class="nx">amd</span>
      <span class="nx">require</span> <span class="p">[</span><span class="s">&#39;xdmessage&#39;</span><span class="p">],</span> <span class="nx">create</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>CommonJS</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">else</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">exports</span> <span class="o">isnt</span> <span class="s">&#39;undefined&#39;</span>
      <span class="nx">create</span> <span class="nx">require</span> <span class="s">&#39;xdmessage&#39;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9">&#182;</a>
</div>
<p>Old School</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">else</span>
      <span class="nx">create</span> <span class="nb">window</span><span class="p">.</span><span class="nx">XDMessage</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
